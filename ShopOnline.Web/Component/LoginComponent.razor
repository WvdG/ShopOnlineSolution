@using ShopOnline.Api.Services

@inject IAuthenticationService AuthService
@inject NavigationManager Navigation

<form>
    <label for="username">Username:</label>
    <input type="text" id="username" @bind="@Username" />
    <br />
    <label for="password">Password:</label>
    <input type="password" id="password" @bind="@Password" />
    <br />
    <button type="button" @onclick="@HandleLogin">Login</button>
</form>

@if (!string.IsNullOrEmpty(Message))
{
    <div class="alert alert-danger" role="alert">
        @Message
    </div>
}

@code {
    private string Username { get; set; }
    private string Password { get; set; }
    private string Message { get; set; }

    private async Task HandleLogin()
    {
        Message = string.Empty;

        if (string.IsNullOrEmpty(Username) || string.IsNullOrEmpty(Password))
        {            
            Message = "Vul een geldige gebruikersnaam en wachtwoord in.";
            return;
        }

        var isAuthenticated = await AuthService.Authenticate(Username, Password);

        if (isAuthenticated)
        {
            Navigation.NavigateTo("/upload-schilderij");
        }
        else
        {
            Message = "Ongeldige gebruikersnaam of wachtwoord.";
        }
    }
}
